<html>
<head>

    <script src="/js/jquery.min.js"></script>

    <script>

        debugMode = true;

        var jsFolder = "/js/";
        var cssFolder = "/css/";
        var navbarFolder = "/navbar/";
        var scriptsFolder = "/scripts/";
        var skinnedFolder = "/skinned/";
        var animationsFolder = "/animations/";
        var componentsFolder = "/components/";
        var menuComponentsFolder = "/components/menu/";
        $.ajaxSetup({ cache: true }); // on production: true.

    </script>

    <script>

    //  caching.js (v1.1)

        function caching( cache, requests, options, cacheName ){

            var Deferreds = [];

            requests.forEach( function( request, i ){
                Deferreds.push( 
                    cache.match( request, options ).then( function( response ){
                        if ( !response ) return request;
                    })
                );
            });

        //  debugMode && console.log( "Deferreds:", Deferreds );
            return Promise.all( Deferreds ).then(function( results ){
                return results.filter(Boolean);

            }).then( function( toCache ){
                debugMode && !!toCache.length && console.log( "Fetching %s...", cacheName );

                return cache.addAll( toCache )
                .catch( function(err){
                    console.error(err);
                }).then(function(){;
                    return toCache;
                });

            }).then( function( toCache ){

                debugMode && toCache.forEach(function( request, i ){
                    var url = window.location.origin + request;
                    debugMode && console.log( "%s-request: %s", cacheName, url );
                });

                return cache.keys().then( function( results ){
                    debugMode && results.forEach(function( item, i ){
                        debugMode && console.log( "%i. %s-cache: %s", i, cacheName, item.url );
                    });
                    return results;
                });

            }).catch( function(err){
                console.error(err);
            });

        }

    </script>

    <script>

        if ( !!window.caches ) {

        //  Cache js.

            var javascriptsCache = "javascripts";
            caches.open( javascriptsCache ).then( function( cache ){

                var cacheName = javascriptsCache;

                var requests = [
                    "/js/jquery.min.js",
                    "/js/jquery-ui.js",
                    "/js/jquery.lazy.js",
                    "/js/jquery.lazy.plugins.js",
                    "/js/jquery.Jcrop.js",
                    "/js/w3.js",
                ];

                var options = {
                    ignoreSearch:true,
                    ignoreMethod:true,
                    ignoreVary:true,
                };

                caching( cache, requests, options, cacheName )
                .then( function( results ){
                    debugMode && console.log( "%s-cache:%o", cacheName, results );
                });

            });

        }

        if ( !!window.caches ) {

        //  Cache components.

            var componentsCache = "components";
            caches.open( componentsCache ).then( function( cache ){

                var cacheName = componentsCache;

                var requests = [
                    "/head-demo.html",
                ];

                var options = {
                    ignoreSearch:true,
                    ignoreMethod:true,
                    ignoreVary:true,
                };

                caching( cache, requests, options, cacheName )
                .then( function( results ){
                    debugMode && console.log( "%s-cache:%o", cacheName, results );
                });

            });

        }

    </script>

    <script>

        var headSelector = "head";
        var demoHeadComponent = "/head-demo.html";
        $(headSelector).load( demoHeadComponent, function(response, status, xhr){
            debugMode && console.log("head-demo:", status);
        })

    </script>

</head>

</body>
</html>
